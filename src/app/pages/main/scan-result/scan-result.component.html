<div class="scan-result-container">
  <h1 class="scan-result-header">Scan results</h1>

  <ng-container *ngIf="urlScanResult$ | async as urlScanResult; else loading">
    <div #scrollBlock class="block scan-result-score">
      <h3>Scores</h3>

      <div class="scan-result-score-list">
        <div class="scan-result-score-item">
          <span class="scan-result-score-label">Vulnerabilities</span>
          <app-score [score]="urlScanResult?.vulnerabilitiesCount"
                     [color]="urlScanResult?.vulnerabilitiesCount > 0 ? '#D00D0DFF' : '#15D015FF'"/>
        </div>
        <div class="scan-result-score-item">
          <span class="scan-result-score-label">Traps</span>
          <app-score [score]="urlScanResult.trapCount"
                     [color]="urlScanResult.trapCount > 0 ? '#D00D0DFF' : '#15D015FF'"/>
        </div>
        <div class="scan-result-score-item">
          <span class="scan-result-score-label">Bad Code</span>

          <app-score [score]="urlScanResult.codeQualityScore"
                     [color]="urlScanResult.codeQualityScore < 50 ? '#D00D0DFF' : '#15D015FF'"/>
        </div>
      </div>
    </div>

    <div #scrollBlock class="block scan-result-chart">
      <h3>Chart</h3>
      <canvas #chart></canvas>
    </div>

    <div #scrollBlock class="block scan-result-tree">
      <h3>Tree</h3>
      <app-tree *ngIf="scrollBlock?.classList?.contains('appear')" [root]="urlScanResult.processNode"></app-tree>
    </div>

    <div #scrollBlock class="block scan-result-virus-table">
      <h3>Viruses</h3>
      <app-virus-table [scanData]="urlScanResult.fileScanResults"/>
    </div>

    <div class="scan-result-download-buttons">
      <button mat-raised-button color="primary" (click)="downloadReport('docx')">Docx</button>
      <button mat-raised-button color="accent" (click)="downloadReport('pdf')">Pdf</button>
    </div>
  </ng-container>

</div>

<ng-template #loading>
  <div class="loading">Loading...</div>
</ng-template>
